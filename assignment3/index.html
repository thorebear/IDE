<!DOCTYPE html>
<html>

<head>

   <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>   

   <!-- BOOTSTRAP CSS -->
   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">

   <!-- JQUERY -->
   <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

   <!-- BOOSTRAP JS -->
   <!-- Latest compiled and minified JavaScript -->
   <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

   <!-- D3 -->
   <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

   <!-- C3 -->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.min.css">
   <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.10/c3.min.js"></script>

   <!-- Our CSS -->
   <style>
   div.container {
      width: 1200;
   }
   .graph {
      padding: 0;
      padding-top: 0;
      padding-bottom: 0;
      margin: 0;
      margin-top: 0;
      margin-bottom: 0;
   }
   </style>

   <title>Interactive Data Exploration - Assignment 3</title>

</head>

<body>

   <div class="jumbotron" id="home">
     <div class="container text-center">
       <h1>Assignment 3</h1>      
       <h3> - By Thorbj√∏rn Christensen and Mads Thoudahl</h3>
     </div>
   </div>

   <div class="container">

      <div class="col-sm-4" class="graph">
         <div id="pcagraph" class="graph"> 
            <noscript> Please turn on JavaScript to display svg here </noscript>
         </div>
         <div id="infograph" class="graph"> 
            <noscript> Please turn on JavaScript to display svg here </noscript>
         </div>
      </div>
      
      <div class="col-sm-8" class="graph">
         <div id="handgraph" class="graph"> 
            <noscript> Please turn on JavaScript to display svg here </noscript>
         </div>
      </div>   

   </div>

   <!-- Our javascript -->
   <script type="text/javascript">
      /* Initialize variables */

      var w, wt, h, ht, padding, circleradius;       
      var handdata, pcadata, info;  /* Handles to datasets    */
      var handmin, handmax, pcamin, pcamax;
      var infosvg, pcasvg, handsvg; /* Handles to svg figures */
      var sxScale, syScale, bxScale, byScale;

      /* Set sizes */
      w = 200;
      h = 200;
      padding = 20;
      wt = w + 2*padding;
      ht = h + 2*padding;

      circleradius = 3;

      d3.select(window).on('load', init);

      /* load data and initialize the svg canvasses */
      function init(){ 
         d3.text("hands_pca.csv", function(text){
            var rows  = d3.csv.parseRows(text);
            pcadata   = rows.map(function(rowt){
                                 return rowt.map(parseFloat);  
            });

            pcamin    = Math.min.apply(null, [].concat.apply([], pcadata));

            pcamax    = Math.max.apply(null, [].concat.apply([], pcadata));

            sxScale   = d3.scale.linear()
                                .domain([pcamin, pcamax])
                                .range([padding, w+padding]);

            syScale   = d3.scale.linear()
                                .domain([pcamin, pcamax])
                                .range([padding, h+padding]);

            initiatePcaGraph(pcadata);
         });

         d3.text("hands.csv", function(text){
            var rows        = d3.csv.parseRows(text);
            var rawhanddata = rows.map(function(row){
                                  return row.map(parseFloat);  
            });
            handdata  = rawhanddata.map(zipRow);

            handmin   = Math.min.apply(null, [].concat.apply([], [].concat.apply([], handdata)));

            handmax   = Math.max.apply(null, [].concat.apply([], [].concat.apply([], handdata)));

            bxScale   = d3.scale.linear()
                                .domain([handmin, handmax])
                                .range([padding, 2*w+padding]);

            byScale   = d3.scale.linear()
                                .domain([handmin, handmax])
                                .range([padding, 2*h+padding]);

            initiateHandGraph(handdata);
         });


         initiateInfoGraph();
      };

      function initiatePcaGraph(pca,i){
         /* create svg and assign to handle */
         pcasvg = d3.select("#pcagraph")
                     .append("svg")
                     .attr("width",wt)
                     .attr("height",ht);

         pcasvg.append("rect")
                .attr("width","100%")
                .attr("height","100%")
                .attr("fill","white")
                .attr("stroke-width","1px")
                .attr("stroke","black");

         /* create a circle for each datapoint */
         pcasvg.selectAll("circle")
            .data(pca)
            .enter()
            .append("circle")
            .attr("cx", function(d){ return sxScale(d[0]);})
            .attr("cy", function(d){ return ht-syScale(d[1]);})
            .attr("r",circleradius);

      };

      function initiateInfoGraph(){
         console.log('initInfoGraph Not Implemented')
         /* create svg and assign to handle */
         infosvg = d3.select("#infograph")
                  .append("svg")
                  .attr("width",wt)
                  .attr("height",ht)

         infosvg.append("rect")
                .attr("width","100%")
                .attr("height","100%")
                .attr("fill","white")
                .attr("stroke-width","1px")
                .attr("stroke","black");
      };

      function initiateHandGraph(d,i){
         console.log('initHandGraph Not Implemented')
         /* create svg and assign to handle */
         handsvg = d3.select("#handgraph")
                  .append("svg")
                  .attr("width",wt*2)
                  .attr("height",ht*2)

         handsvg.append("rect")
                .attr("width","100%")
                .attr("height","100%")
                .attr("fill","white")
                .attr("stroke-width","1px")
                .attr("stroke","black");
      };

      function zipRow(row){
         var xs   = row.slice( 0, Math.floor(row.length/2));
         var ys   = row.slice( Math.floor(row.length / 2), row.length);
         return d3.zip( xs, ys );
      };



   </script>

</body>

</html>
